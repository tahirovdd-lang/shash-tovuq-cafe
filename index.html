<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Menu</title>

  <style>
    :root{
      --bg:#f6f7fb;
      --card:#ffffff;
      --text:#121212;
      --muted:#6b7280;
      --line: rgba(0,0,0,.08);
      --shadow: 0 14px 34px rgba(0,0,0,.10);
      --r:18px;
      --accent:#ff1b2d;
    }
    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    .wrap{ max-width:1100px; margin:0 auto; padding:14px 14px 120px; }

    .topbar{
      position: sticky; top:0; z-index:10;
      background: linear-gradient(180deg, rgba(246,247,251,.96), rgba(246,247,251,.72));
      backdrop-filter: blur(10px);
      padding: 10px 0 12px;
      border-bottom: 1px solid var(--line);
    }

    .title{
      font-weight:900;
      font-size:18px;
      letter-spacing:.2px;
      margin: 0 14px 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .badge{
      font-size:12px;
      color:white;
      background: var(--accent);
      padding:6px 10px;
      border-radius:999px;
      font-weight:800;
      white-space:nowrap;
    }

    .cats{
      display:flex;
      gap:10px;
      padding: 0 14px;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .cats::-webkit-scrollbar{ display:none; }
    .cat{
      flex:0 0 auto;
      padding:10px 14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.7);
      border-radius:999px;
      font-weight:800;
      font-size:13px;
      color:#111;
      cursor:pointer;
      user-select:none;
    }
    .cat.active{
      background: #111;
      color:#fff;
      border-color:#111;
    }

    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:12px;
      padding:14px;
    }
    @media (min-width: 820px){
      .grid{ grid-template-columns: repeat(4, minmax(0, 1fr)); }
    }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height: 220px;
    }

    .imgWrap{
      position:relative;
      width:100%;
      aspect-ratio: 4 / 3;
      overflow:hidden;
      background:#f2f2f2;
    }
    .imgWrap img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      cursor: zoom-in;
    }
    .zoomHint{
      position:absolute;
      left:10px; bottom:10px;
      background: rgba(0,0,0,.55);
      color:#fff;
      font-size:11px;
      padding:6px 8px;
      border-radius:999px;
      font-weight:800;
    }

    .info{
      padding:12px 12px 14px;
      display:flex;
      flex-direction:column;
      gap:8px;
      flex:1;
    }
    .name{
      font-weight:900;
      font-size:14px;
      line-height:1.15;
    }
    .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-top:auto;
    }
    .price{
      font-weight:900;
      font-size:14px;
      color:#111;
    }
    .muted{ color:var(--muted); font-size:12px; font-weight:700; }

    /* ===== LIGHTBOX (Zoom) ===== */
    .lb{
      position:fixed;
      inset:0;
      z-index:9999;
      background: rgba(0,0,0,.75);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 10px;
    }
    .lb.show{ display:flex; }

    .lbInner{
      position:relative;
      width: min(980px, 100%);
      height: min(720px, 100%);
      border-radius: 18px;
      overflow:hidden;
      background: rgba(20,20,20,.92);
      border: 1px solid rgba(255,255,255,.12);
    }

    /* Важно: touch-action для pinch-zoom */
    .lbCanvas{
      width:100%;
      height:100%;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
      touch-action: pinch-zoom;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 22px;
    }

    .lbCanvas img{
      max-width: 100%;
      max-height: 100%;
      transform-origin: center center;
      display:block;
      border-radius: 14px;
      box-shadow: 0 22px 60px rgba(0,0,0,.35);
      user-select:none;
      -webkit-user-drag:none;
    }

    .lbTop{
      position:absolute;
      top:10px;
      left:10px;
      right:10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      pointer-events:none;
    }
    .lbTitle{
      pointer-events:auto;
      color:#fff;
      font-weight:900;
      font-size:13px;
      background: rgba(0,0,0,.45);
      border:1px solid rgba(255,255,255,.14);
      padding:8px 10px;
      border-radius:999px;
      max-width: 70%;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .lbBtns{
      pointer-events:auto;
      display:flex;
      gap:8px;
    }
    .btn{
      border:none;
      background: rgba(255,255,255,.14);
      color:#fff;
      font-weight:900;
      padding:10px 12px;
      border-radius:999px;
      cursor:pointer;
      border:1px solid rgba(255,255,255,.18);
      font-size:13px;
    }
    .btn:active{ transform: translateY(1px); }

    .lbHint{
      position:absolute;
      bottom:12px;
      left:12px;
      right:12px;
      display:flex;
      justify-content:center;
      pointer-events:none;
    }
    .lbHint span{
      pointer-events:none;
      color:#fff;
      font-size:12px;
      font-weight:800;
      background: rgba(0,0,0,.45);
      border:1px solid rgba(255,255,255,.14);
      padding:8px 12px;
      border-radius:999px;
    }

    /* Small phones */
    @media (max-width:420px){
      .grid{ grid-template-columns: 1fr; }
      .card{ min-height: 240px; }
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="title">
      <div>Меню</div>
      <div class="badge">NEW • Акции</div>
    </div>
    <div class="cats" id="cats"></div>
  </div>

  <div class="wrap">
    <div class="grid" id="grid"></div>
  </div>

  <!-- LIGHTBOX -->
  <div class="lb" id="lb" aria-hidden="true">
    <div class="lbInner" role="dialog" aria-modal="true">
      <div class="lbTop">
        <div class="lbTitle" id="lbTitle">Фото</div>
        <div class="lbBtns">
          <button class="btn" id="zoomOut" type="button">−</button>
          <button class="btn" id="zoomReset" type="button">100%</button>
          <button class="btn" id="zoomIn" type="button">+</button>
          <button class="btn" id="lbClose" type="button">✕</button>
        </div>
      </div>

      <div class="lbCanvas" id="lbCanvas">
        <img id="lbImg" alt="preview" />
      </div>

      <div class="lbHint"><span>Колёсико/кнопки — зум • На телефоне можно pinch</span></div>
    </div>
  </div>

  <script>
    /* ===== ДАННЫЕ (добавляй свои позиции здесь) ===== */
    const CATEGORIES = [
      "Long Chesse",  // ✅ ТОП категория (первая)
      "Комбо",
      "Лаваш",
      "Бургер",
      "Напитки",
    ];

    const ITEMS = [
      {
        cat: "Long Chesse",
        name: "Long Chesse",
        price: "—",
        img: "images/long_chesse.jpg" // поменяй на свой файл
      },
      {
        cat: "Комбо",
        name: "Lavash Combo",
        price: "28 000",
        img: "images/lavash_combo_promo.jpg"
      },
      {
        cat: "Напитки",
        name: "Coca Cola 0.5L",
        price: "8 000",
        img: "images/coca_05.jpg"
      }
    ];

    /* ===== РЕНДЕР ===== */
    const catsEl = document.getElementById("cats");
    const gridEl = document.getElementById("grid");

    let activeCat = CATEGORIES[0];

    function renderCats(){
      catsEl.innerHTML = "";
      CATEGORIES.forEach(c => {
        const b = document.createElement("div");
        b.className = "cat" + (c === activeCat ? " active" : "");
        b.textContent = c;
        b.onclick = () => { activeCat = c; renderCats(); renderGrid(); };
        catsEl.appendChild(b);
      });
    }

    function renderGrid(){
      gridEl.innerHTML = "";
      const list = ITEMS.filter(x => x.cat === activeCat);
      if(!list.length){
        const empty = document.createElement("div");
        empty.style.padding = "14px";
        empty.innerHTML = "<div class='muted'>Нет товаров в этой категории</div>";
        gridEl.appendChild(empty);
        return;
      }

      list.forEach(item => {
        const card = document.createElement("div");
        card.className = "card";

        const imgWrap = document.createElement("div");
        imgWrap.className = "imgWrap";

        const img = document.createElement("img");
        img.src = item.img;
        img.alt = item.name;

        // ✅ ВАЖНО: кликаем по img — открываем зум без ошибок
        img.addEventListener("click", (e) => {
          e.preventDefault();
          e.stopPropagation();
          openLightbox(item.img, item.name);
        });

        imgWrap.appendChild(img);

        const hint = document.createElement("div");
        hint.className = "zoomHint";
        hint.textContent = "Нажми для увеличения";
        imgWrap.appendChild(hint);

        const info = document.createElement("div");
        info.className = "info";

        const name = document.createElement("div");
        name.className = "name";
        name.textContent = item.name;

        const row = document.createElement("div");
        row.className = "row";

        const price = document.createElement("div");
        price.className = "price";
        price.textContent = item.price;

        const sub = document.createElement("div");
        sub.className = "muted";
        sub.textContent = item.cat;

        row.appendChild(sub);
        row.appendChild(price);

        info.appendChild(name);
        info.appendChild(row);

        card.appendChild(imgWrap);
        card.appendChild(info);

        gridEl.appendChild(card);
      });
    }

    /* ===== LIGHTBOX ZOOM (стабильно) ===== */
    const lb = document.getElementById("lb");
    const lbImg = document.getElementById("lbImg");
    const lbTitle = document.getElementById("lbTitle");
    const lbCanvas = document.getElementById("lbCanvas");

    const zoomInBtn = document.getElementById("zoomIn");
    const zoomOutBtn = document.getElementById("zoomOut");
    const zoomResetBtn = document.getElementById("zoomReset");
    const lbCloseBtn = document.getElementById("lbClose");

    let scale = 1;

    function applyScale(){
      lbImg.style.transform = `scale(${scale})`;
      zoomResetBtn.textContent = Math.round(scale * 100) + "%";
    }

    function openLightbox(src, title){
      lbImg.src = src;
      lbTitle.textContent = title || "Фото";
      scale = 1;
      applyScale();
      lb.classList.add("show");
      lb.setAttribute("aria-hidden", "false");

      // сброс скролла
      lbCanvas.scrollTop = 0;
      lbCanvas.scrollLeft = 0;
    }

    function closeLightbox(){
      lb.classList.remove("show");
      lb.setAttribute("aria-hidden", "true");
      lbImg.src = "";
    }

    // Закрытие
    lbCloseBtn.addEventListener("click", closeLightbox);
    lb.addEventListener("click", (e) => {
      // закрыть только если тап по затемнению, не по внутреннему блоку
      if(e.target === lb) closeLightbox();
    });
    document.addEventListener("keydown", (e) => {
      if(e.key === "Escape" && lb.classList.contains("show")) closeLightbox();
    });

    // Кнопки zoom
    zoomInBtn.addEventListener("click", () => {
      scale = Math.min(4, +(scale + 0.25).toFixed(2));
      applyScale();
    });
    zoomOutBtn.addEventListener("click", () => {
      scale = Math.max(1, +(scale - 0.25).toFixed(2));
      applyScale();
    });
    zoomResetBtn.addEventListener("click", () => {
      scale = 1;
      applyScale();
    });

    // Колесо мыши (десктоп)
    lbCanvas.addEventListener("wheel", (e) => {
      if(!lb.classList.contains("show")) return;
      // ctrl+wheel — обычно зум браузера, но мы сделаем зум картинки
      e.preventDefault();
      const delta = Math.sign(e.deltaY);
      if(delta > 0) scale = Math.max(1, +(scale - 0.15).toFixed(2));
      else scale = Math.min(4, +(scale + 0.15).toFixed(2));
      applyScale();
    }, { passive:false });

    /* INIT */
    renderCats();
    renderGrid();
  </script>
</body>
</html>
